<!-- HEADER CARD -->
<mat-card class="employee-btn">

  <!-- CARD HEADER ROW -->
  <div class="card-header-row">

    <!-- SEARCH + ADD BUTTON -->
 <div class="header-actions">
  <div class="toolbar">

    <!-- SEARCH BAR WITH SEARCH ICON -->
    <div class="search-container">
      <mat-icon class="search-icon">search</mat-icon>
      <input 
        type="text"
        [(ngModel)]="searchTerm"
        (input)="filterData()"
        placeholder="Search"
        class="search-input"
      />
      <button *ngIf="searchTerm" class="clear-btn" (click)="searchTerm=''; filterData()">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <!-- ADD EMPLOYEE BUTTON -->
    <button mat-raised-button class="custom-primary action-btn" (click)="openAddModal()">
      <mat-icon>person_add</mat-icon>
      Add Employee
    </button>

  </div>
</div>



  </div>

</mat-card>

<!-- TABLE CARD -->
<mat-card class="employee-card">

  <!-- *** SCROLLABLE TABLE AREA *** -->
  <div class="table-container">

<table mat-table [dataSource]="sortedDataSource" matSort class="styled-table">

  <!-- EMPLOYEE NAME -->
  <ng-container matColumnDef="employeename">
    <th mat-header-cell *matHeaderCellDef class="text-center" 
        (click)="sortData('employeeName')" style="cursor:pointer">
      Name
      <mat-icon>
        {{ sortColumn === 'employeeName' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'swap_vert' }}
      </mat-icon>
    </th>
    <td mat-cell *matCellDef="let row">
      <span matTooltip="{{ row.employeeName }}" class="truncate">
        {{ row.employeeName }}
      </span>
    </td>
  </ng-container>
 <!-- EMAIL -->
  <ng-container matColumnDef="email">
    <th mat-header-cell *matHeaderCellDef class="text-center" 
        (click)="sortData('email')" style="cursor:pointer">
      Email
      <mat-icon>
        {{ sortColumn === 'email' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'swap_vert' }}
      </mat-icon>
    </th>
    <td mat-cell *matCellDef="let row">
      <span matTooltip="{{ row.email }}" class="truncate">
        {{ row.email }}
      </span>
    </td>
  </ng-container>

  <!-- GENDER -->
  <ng-container matColumnDef="gender">
    <th mat-header-cell *matHeaderCellDef class="header-large">Gender</th>
    <td mat-cell *matCellDef="let row">
      <span matTooltip="{{ row.gender }}" class="truncate">
        {{ row.gender }}
      </span>
    </td>
  </ng-container>

  <!-- PHONE -->
  <ng-container matColumnDef="phoneNo">
    <th mat-header-cell *matHeaderCellDef class="text-center" 
        (click)="sortData('phoneNo')" style="cursor:pointer">
      Phone
      <mat-icon>
        {{ sortColumn === 'phoneNo' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'swap_vert' }}
      </mat-icon>
    </th>
    <td mat-cell *matCellDef="let row">
      <span matTooltip="{{ row.phoneNo }}" class="truncate">
        {{ row.phoneNo }}
      </span>
    </td>
  </ng-container>

  <!-- DOB -->
  <ng-container matColumnDef="dob">
    <th mat-header-cell *matHeaderCellDef class="text-center" 
        (click)="sortData('dob')" style="cursor:pointer">
      DOB
      <mat-icon>
        {{ sortColumn === 'dob' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'swap_vert' }}
      </mat-icon>
    </th>
    <td mat-cell *matCellDef="let row">
      <span matTooltip="{{ row.dob | date:'dd-MMM-yyyy' }}" class="truncate">
        {{ row.dob | date:'dd-MMM-yyyy' }}
      </span>
    </td>
  </ng-container>

  <!-- SKILLS -->
  <ng-container matColumnDef="skills">
    <th mat-header-cell *matHeaderCellDef class="text-center" 
        (click)="sortData('skills')" style="cursor:pointer">
      Skills
      <mat-icon>
        {{ sortColumn === 'skills' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'swap_vert' }}
      </mat-icon>
    </th>
    <td mat-cell *matCellDef="let row">
      <span matTooltip="{{ row.skills?.join(', ') }}" class="truncate">
        {{ row.skills?.join(', ') }}
      </span>
    </td>
  </ng-container>

  <!-- DEPARTMENT -->
  <ng-container matColumnDef="departmentName">
    <th mat-header-cell *matHeaderCellDef class="text-center" 
        (click)="sortData('departmentName')" style="cursor:pointer">
      Department
      <mat-icon>
        {{ sortColumn === 'departmentName' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'swap_vert' }}
      </mat-icon>
    </th>
    <td mat-cell *matCellDef="let row">
      <span matTooltip="{{ row.departmentName }}" class="truncate">
        {{ row.departmentName }}
      </span>
    </td>
  </ng-container>

  <!-- QUALIFICATION -->
  <ng-container matColumnDef="qualificationName">
    <th mat-header-cell *matHeaderCellDef class="text-center" 
        (click)="sortData('qualificationName')" style="cursor:pointer">
      Qualification
      <mat-icon>
        {{ sortColumn === 'qualificationName' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'swap_vert' }}
      </mat-icon>
    </th>
    <td mat-cell *matCellDef="let row">
      <span matTooltip="{{ row.qualificationName }}" class="truncate">
        {{ row.qualificationName }}
      </span>
    </td>
  </ng-container>

  <!-- DATE OF JOINING -->
  <ng-container matColumnDef="dateOfJoining">
    <th mat-header-cell *matHeaderCellDef class="text-center" 
        (click)="sortData('dateOfJoining')" style="cursor:pointer">
      Date of Joining
      <mat-icon>
        {{ sortColumn === 'dateOfJoining' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'swap_vert' }}
      </mat-icon>
    </th>
    <td mat-cell *matCellDef="let row">
      <span matTooltip="{{ row.dateOfJoining | date:'dd-MMM-yyyy' }}" class="truncate">
        {{ row.dateOfJoining | date:'dd-MMM-yyyy' }}
      </span>
    </td>
  </ng-container>

  <!-- ACTIVE STATUS -->
<ng-container matColumnDef="isActive">
  <th mat-header-cell *matHeaderCellDef class="text-center">Status</th>

  <td mat-cell *matCellDef="let row">
    <span class="status-chip" [ngClass]="row.isActive ? 'chip-active' : 'chip-inactive'">
      <mat-icon class="chip-icon">
        {{ row.isActive ? 'check_circle' : 'cancel' }}
      </mat-icon>
      {{ row.isActive ? 'Active' : 'Inactive' }}
    </span>
  </td>
</ng-container>

  <!-- ACTIONS -->
  <ng-container matColumnDef="action">
    <th mat-header-cell *matHeaderCellDef class="header-large">Actions</th>
    <td mat-cell *matCellDef="let row" class="action-cell">
      <button mat-icon-button color="primary" matTooltip="Edit Employee" (click)="openEditModal(row)">
        <mat-icon>edit</mat-icon>
      </button>
      <button mat-icon-button color="primary" matTooltip="Delete Employee" (click)="confirmDelete(row)">
        <mat-icon>delete</mat-icon>
      </button>
    </td>
  </ng-container>
  <!-- Header & Row Definitions -->
  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

</table>


  </div>

</mat-card>
<!-- TABLE FOOTER -->
<!-- SIMPLE FOOTER -->
<footer class="app-footer">
  <div class="footer-left">
  Â© 2025 <span class="company-name">VKOMAK Technologies</span>
</div>

  <div class="footer-right">
    {{ currentDate }}
  </div>
</footer>




<!-- ========================================= -->
<!--                 MODAL POPUP               -->
<!-- ========================================= -->

<div class="custom-modal-backdrop" *ngIf="showModal">
  <div class="custom-modal">

    <!-- HEADER -->
    <div class="modal-header text-dark">
      <h3>{{ modalTitle }}</h3>
      <button class="close-btn style2" (click)="closeModal()">
  <i class="bi bi-x"></i>
</button>

    </div>

    <!-- BODY -->
    <form #f="ngForm">
      <div class="modal-body form-grid">
  <!-- Roll No -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label >Roll No</mat-label>
          <input matInput maxlength="6" placeholder="Enter Roll No" required
                 [(ngModel)]="currentItem.pinCode" name="pinCode"
                 (keypress)="allowNumbersOnly($event)">
          <mat-error *ngIf="f.controls['pinCode']?.invalid && f.controls['pinCode']?.touched">
            Roll No is required
          </mat-error>
        </mat-form-field>

        <!-- Name -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Name</mat-label>
          <input matInput placeholder="Enter Your Name" required
                 [(ngModel)]="currentItem.employeeName" name="employeeName">
          <mat-error *ngIf="f.controls['employeeName']?.invalid && f.controls['employeeName']?.touched">
            Name is required
          </mat-error>
        </mat-form-field>

        <!-- Email -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Email</mat-label>
          <input matInput placeholder="Enter Email" required email
                 [(ngModel)]="currentItem.email" name="email">
          <mat-error *ngIf="f.controls['email']?.invalid && f.controls['email']?.touched">
            Valid Email is required
          </mat-error>
        </mat-form-field>

        <!-- Gender -->
        <div class="gender-wrapper">
          <mat-label>Gender</mat-label>
          <mat-radio-group color="accent" [(ngModel)]="currentItem.gender" name="gender" required>
            <mat-radio-button value="Male">Male</mat-radio-button>
            <mat-radio-button value="Female">Female</mat-radio-button>
          </mat-radio-group>
        </div>

       <!-- Date of Birth -->
<mat-form-field appearance="outline" class="dob-field full-width">
  <mat-label>Date of Birth</mat-label>

  <input matInput
         [matDatepicker]="dobPicker"
         placeholder="Select Date of Birth"
         required
         [(ngModel)]="currentItem.dob"
         name="dob"
         [max]="maxDob">

  <mat-datepicker-toggle matSuffix [for]="dobPicker"></mat-datepicker-toggle>

  <!-- Right-aligned calendar -->
  <mat-datepicker #dobPicker panelClass="calendar-right"></mat-datepicker>

  <mat-error *ngIf="f.controls['dob']?.invalid && f.controls['dob']?.touched">
    Date of Birth is below 2007 - Required
  </mat-error>
</mat-form-field>


<!-- Date of Joining -->
<mat-form-field appearance="outline" class="doj-field full-width">
  <mat-label>Date of Joining</mat-label>

  <input matInput
         [matDatepicker]="dojPicker"
         placeholder="Select Date of Joining"
         required
         [(ngModel)]="currentItem.dateOfJoining"
         name="doj"
         [max]="maxDate">

  <mat-datepicker-toggle matSuffix [for]="dojPicker"></mat-datepicker-toggle>

  <!-- Right-aligned calendar -->
  <mat-datepicker #dojPicker panelClass="full-width-datepicker"></mat-datepicker>

  <mat-error *ngIf="f.controls['doj']?.invalid && f.controls['doj']?.touched">
    Date of Joining is required
  </mat-error>
</mat-form-field>


        <!-- Phone -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Phone</mat-label>
          <input matInput maxlength="10" placeholder="Enter Phone" required
                 [(ngModel)]="currentItem.phoneNo" name="phoneNo"
                 (keypress)="allowNumbersOnly($event)">
          <mat-error *ngIf="f.controls['phoneNo']?.invalid && f.controls['phoneNo']?.touched">
            Phone is required
          </mat-error>
        </mat-form-field>

        <!-- Age -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Age</mat-label>
          <input matInput type="number" min="17" maxlength="3" placeholder="Enter Your Age" required
                 [(ngModel)]="currentItem.age" name="age" (keypress)="allowNumbersOnly($event)">
          <mat-error *ngIf="f.controls['age']?.invalid && f.controls['age']?.touched">
            Age should be above 17 is required
          </mat-error>
        </mat-form-field>

        <!-- Skills -->
        <mat-form-field appearance="outline" class="skills-field full-width">
          <mat-label>Skills</mat-label>
          <mat-select panelClass="inside-modal" placeholder="Select Skills"
                      [(ngModel)]="currentItem.skills" name="skills" multiple required>
            <mat-option *ngFor="let s of skillsList" [value]="s">{{ s }}</mat-option>
          </mat-select>
          <mat-error *ngIf="f.controls['skills']?.invalid && f.controls['skills']?.touched">
            Please select at least one skill
          </mat-error>
        </mat-form-field>

        <!-- Qualification -->
        <mat-form-field appearance="outline" class="qual-field full-width">
          <mat-label>Qualification</mat-label>
          <mat-select panelClass="inside-modal" placeholder="Select Qualification"
                      [(ngModel)]="currentItem.mQualificationId" name="mQualificationId" required>
            <mat-option *ngFor="let q of qualificationList" [value]="q.mQualificationId">
              {{ q.qualificationName }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="f.controls['mQualificationId']?.invalid && f.controls['mQualificationId']?.touched">
            Qualification is required
          </mat-error>
        </mat-form-field>

        <!-- Department -->
        <mat-form-field appearance="outline" class="dept-field full-width">
          <mat-label>Department</mat-label>
          <mat-select panelClass="inside-modal" placeholder="Select Department"
                      [(ngModel)]="currentItem.mDepartmentId" name="mDepartmentId" required>
            <mat-option *ngFor="let d of departmentList" [value]="d.mDepartmentId">
              {{ d.departmentName }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="f.controls['mDepartmentId']?.invalid && f.controls['mDepartmentId']?.touched">
            Department is required
          </mat-error>
        </mat-form-field>

  <!-- <div class="mb-3">
    <mat-checkbox [(ngModel)]="currentItem.isActive" >
      Is Active
    </mat-checkbox>
  </div> -->

     </div>
      </form>
 <div class="mb-3">
    <mat-checkbox [(ngModel)]="currentItem.isActive" >
      Is Active
    </mat-checkbox>
  </div>
    
    <!-- FOOTER -->
    <div class="modal-footer">
      <button mat-stroked-button class="reset-btn" (click)="resetForm()">Reset</button>

      <button mat-raised-button color="primary" (click)="save()" [disabled]="f.invalid">Save</button>
    </div>

  </div>
</div>
